<ui:composition 
    template="/templates/layout.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="conteudo">

        <h:form id="formPaciente">

            <p:panel header="Cadastro de Pacientes">

                <p:messages id="msgs" autoUpdate="true" closable="true" />

                <h:panelGrid columns="2" columnClasses="label,value" cellpadding="5">

                    <h:outputLabel value="Nome:" for="nome" />
                    <p:inputText id="nome" 
                                 value="#{pacienteBean.paciente.nome}" 
                                 required="true" />

                    <h:outputLabel value="CPF:" for="cpf" />
                    <p:inputMask id="cpf" 
                                 value="#{pacienteBean.paciente.cpf}" 
                                 mask="999.999.999-99" />

                    <h:outputLabel value="Telefone:" for="tel" />
                    <p:inputMask id="tel" 
                                 value="#{pacienteBean.paciente.telefone}" 
                                 mask="(99) 99999-9999" />

                    <h:outputLabel value="Email:" for="email" />
                    <p:inputText id="email" 
                                 value="#{pacienteBean.paciente.email}" />

                    <h:outputLabel value="Endereço:" for="end" />
                    <p:inputTextarea id="end" rows="3" 
                                     value="#{pacienteBean.paciente.endereco}" />

                </h:panelGrid>

                <p:commandButton value="Salvar" 
                                 action="#{pacienteBean.salvar}" 
                                 update="@form tabelaPacientes msgs" 
                                 style="margin-top:10px;" />

                <p:commandButton value="Novo" 
                                 action="#{pacienteBean.novo}" 
                                 update="@form" 
                                 style="margin-left:10px;" />

                <p:separator style="margin: 15px 0" />

                <!-- TABELA -->
                <p:dataTable id="tabelaPacientes"
                             value="#{pacienteBean.pacientes}" 
                             var="p"
                             paginator="true" rows="10"
                             rowKey="#{p.id}"
                             emptyMessage="Nenhum paciente cadastrado">

                    <p:column headerText="Nome">
                        #{p.nome}
                    </p:column>

                    <p:column headerText="CPF">
                        #{p.cpf}
                    </p:column>

                    <p:column headerText="Telefone">
                        #{p.telefone}
                    </p:column>

                    <p:column headerText="Ações" style="width:150px;">

                        <!-- EDITAR -->
                        <p:commandButton icon="pi pi-pencil"
                                         action="#{pacienteBean.editar(p)}"
                                         update="@form"
                                         styleClass="ui-button-info"
                                         process="@this" />

                        <!-- REMOVER -->
                        <p:commandButton icon="pi pi-trash"
                                         action="#{pacienteBean.remover(p)}"
                                         update="tabelaPacientes msgs"
                                         styleClass="ui-button-danger"
                                         process="@this" />

                    </p:column>

                </p:dataTable>

            </p:panel>

        </h:form>

    </ui:define>

</ui:composition>
